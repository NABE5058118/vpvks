# VPN Bot Project - –ü–æ–ª–Ω–æ–µ —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ

> **–ü–æ—Å–ª–µ–¥–Ω–µ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ:** 20 —Ñ–µ–≤—Ä–∞–ª—è 2026 –≥., 17:30 (MSK)
> **–°—Ç–∞—Ç—É—Å:** ‚úÖ –ü—Ä–æ–¥–∞–∫—à–µ–Ω —Ä–∞–∑–≤—ë—Ä–Ω—É—Ç –∏ —Ä–∞–±–æ—Ç–∞–µ—Ç
> **WireGuard:** ‚úÖ API —Ä–∞–±–æ—Ç–∞–µ—Ç, QR-–∫–æ–¥—ã –≥–µ–Ω–µ—Ä–∏—Ä—É—é—Ç—Å—è
> **–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å:** ‚úÖ –ü—Ä–æ—Ü–µ—Å—Å—ã –∑–∞–ø—É—â–µ–Ω—ã –æ—Ç `vpvks`, –∞–≤—Ç–æ–∑–∞–ø—É—Å–∫ —á–µ—Ä–µ–∑ systemd
> **PgBouncer:** ‚úÖ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∞ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è, backend —É—Å–ø–µ—à–Ω–æ –ø–æ–¥–∫–ª—é—á–∞–µ—Ç—Å—è –∫ –ë–î

## –û–ø–∏—Å–∞–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞

Telegram-–±–æ—Ç –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è VPN-–ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è–º–∏ —Å –º–∏–Ω–∏-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ–º, —Å–∏—Å—Ç–µ–º–æ–π –æ–ø–ª–∞—Ç—ã –∏ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–µ–π —Å WireGuard.

## –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

### –¢–µ–∫—É—â–∞—è (Docker + nginx + systemd)

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ   nginx:443     ‚îÇ HTTPS (SSL)
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
         ‚îÇ
         ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê     ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê     ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  Backend:8080   ‚îÇ‚îÄ‚îÄ‚îÄ‚îÄ‚ñ∂‚îÇ  PgBouncer:5432 ‚îÇ‚îÄ‚îÄ‚îÄ‚îÄ‚ñ∂‚îÇ  PostgreSQL:5432‚îÇ
‚îÇ  (Flask)        ‚îÇ     ‚îÇ  (pooler)       ‚îÇ     ‚îÇ  (Docker)       ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò     ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò     ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
         ‚ñ≤
         ‚îÇ
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  Bot            ‚îÇ Telegram API
‚îÇ  (polling)      ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

–í—Å–µ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã –∑–∞–ø—É—Å–∫–∞—é—Ç—Å—è **–æ—Ç –Ω–µ–ø—Ä–∏–≤–∏–ª–µ–≥–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è `vpvks`** —á–µ—Ä–µ–∑ systemd-—Å–µ—Ä–≤–∏—Å, —á—Ç–æ –ø–æ–≤—ã—à–∞–µ—Ç –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å.

### –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
/opt/vpvks/               # –î–æ–º–∞—à–Ω–∏–π –∫–∞—Ç–∞–ª–æ–≥ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è vpvks
‚îú‚îÄ‚îÄ backend/               # Flask —Å–µ—Ä–≤–µ—Ä (–ø–æ—Ä—Ç 8080)
‚îú‚îÄ‚îÄ bot/                   # Telegram –±–æ—Ç
‚îú‚îÄ‚îÄ pgbouncer/             # –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è PgBouncer (–º–æ–Ω—Ç–∏—Ä—É–µ—Ç—Å—è –≤ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä)
‚îú‚îÄ‚îÄ docker-compose.yml     # –æ—Ä–∫–µ—Å—Ç—Ä–∞—Ü–∏—è –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤
‚îú‚îÄ‚îÄ .env                   # –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è (—Å–µ–∫—Ä–µ—Ç—ã)
‚îú‚îÄ‚îÄ .git/                  # git-—Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π
‚îî‚îÄ‚îÄ ... (–¥—Ä—É–≥–∏–µ —Ñ–∞–π–ª—ã)
```

## –í—ã–ø–æ–ª–Ω–µ–Ω–Ω—ã–µ –∑–∞–¥–∞—á–∏ ‚úÖ

### üöÄ –ü—Ä–æ–¥–∞–∫—à–µ–Ω —Ä–∞–∑–≤—ë—Ä–Ω—É—Ç (19 —Ñ–µ–≤—Ä–∞–ª—è 2026)

#### Docker –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã
- [x] **PostgreSQL 17-alpine** ‚Äî –±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö –≤ Docker (19.02.2026, 10:00)
- [x] **PgBouncer** ‚Äî connection pooler (–ø–æ—Ä—Ç 5432, auth: scram-sha-256) (19.02.2026, 11:00)
- [x] **Backend (Flask)** ‚Äî API —Å–µ—Ä–≤–µ—Ä (–ø–æ—Ä—Ç 8080) (19.02.2026, 10:30)
- [x] **Bot (python-telegram-bot)** ‚Äî Telegram –±–æ—Ç (polling) (19.02.2026, 10:30)
- [x] **docker-compose.yml** ‚Äî –æ—Ä–∫–µ—Å—Ç—Ä–∞—Ü–∏—è –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤ (19.02.2026, 10:00)

#### –ò–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–∞
- [x] –°–µ—Ä–≤–µ—Ä Ubuntu 24.04.4 LTS –Ω–∞—Å—Ç—Ä–æ–µ–Ω (19.02.2026, 09:00)
- [x] **nginx** –Ω–∞—Å—Ç—Ä–æ–µ–Ω –∫–∞–∫ reverse proxy (19.02.2026, 09:30)
- [x] **SSL-—Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç** (Let's Encrypt) —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω (19.02.2026, 09:45)
- [x] **–î–æ–º–µ–Ω –∫—É–ø–ª–µ–Ω**: `vpvks.ru` (19.02.2026, 08:00)
- [x] **DNS –Ω–∞—Å—Ç—Ä–æ–µ–Ω**: A-–∑–∞–ø–∏—Å—å –Ω–∞ `23.134.216.190` (19.02.2026, 08:30)
- [x] **Docker —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω** –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ (19.02.2026, 09:15)
- [x] **–°–æ–∑–¥–∞–Ω –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å `vpvks`** –¥–ª—è –∏–∑–æ–ª—è—Ü–∏–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è (20.02.2026, 10:30)
- [x] **–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –¥–æ–±–∞–≤–ª–µ–Ω –≤ –≥—Ä—É–ø–ø—É `docker`** (20.02.2026, 10:35)
- [x] **–ù–∞—Å—Ç—Ä–æ–µ–Ω systemd-—Å–µ—Ä–≤–∏—Å `docker-vpvks`** –¥–ª—è –∞–≤—Ç–æ–∑–∞–ø—É—Å–∫–∞ (20.02.2026, 10:40)

### –ë–æ—Ç –∏ Backend
- [x] –ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–µ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –∫–æ–º–∞–Ω–¥ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω—ã (19.02.2026, 12:00)
- [x] –ö–æ–º–∞–Ω–¥–∞ `/start` —Ä–∞–±–æ—Ç–∞–µ—Ç ‚úÖ (19.02.2026, 12:05)
- [x] –ö–æ–º–∞–Ω–¥–∞ `/app` –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç –º–∏–Ω–∏-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ ‚úÖ (19.02.2026, 12:10)
- [x] –ö–æ–º–∞–Ω–¥–∞ `/admin` –¥–æ—Å—Ç—É–ø–Ω–∞ –¥–ª—è –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–æ–≤ ‚úÖ (19.02.2026, 12:15)
- [x] –¢–µ—Å—Ç–æ–≤–∞—è –æ–ø–ª–∞—Ç–∞ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞ (19.02.2026, 13:00)
- [x] –î–∞—Ç–∞ –ø–æ–¥–ø–∏—Å–∫–∏ –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è –ø–æ—Å–ª–µ –ø–æ–∫—É–ø–∫–∏ (19.02.2026, 13:30)
- [x] –ù–∏–∫–Ω–µ–π–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è –≤ —à–∞–ø–∫–µ –º–∏–Ω–∏-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è (19.02.2026, 14:00)
- [x] ID –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –≤—ã—Ä–æ–≤–Ω–µ–Ω –ø–æ –ª–µ–≤–æ–º—É –∫—Ä–∞—é (19.02.2026, 14:05)

### –ú–∏–Ω–∏-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ (20.02.2026)
- [x] –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ —Å—Ç–∞—Ç—É—Å–∞ –ø–æ–¥–ø–∏—Å–∫–∏ (19.02.2026, 12:30)
- [x] –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –¥–∞—Ç—ã –æ–∫–æ–Ω—á–∞–Ω–∏—è –ø–æ–¥–ø–∏—Å–∫–∏ (19.02.2026, 12:35)
- [x] –ö–Ω–æ–ø–∫–∞ "–û–±–Ω–æ–≤–∏—Ç—å —Å—Ç–∞—Ç—É—Å" (19.02.2026, 12:40)
- [x] –ö–Ω–æ–ø–∫–∏ –ø–æ–∫—É–ø–∫–∏ —Ç–∞—Ä–∏—Ñ–æ–≤ (1 –º–µ—Å, 4 –º–µ—Å, 12 –º–µ—Å) (19.02.2026, 12:45)
- [x] iOS —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å (tg.openLink –≤–º–µ—Å—Ç–æ window.open) (19.02.2026, 12:50)
- [x] **–í–∫–ª–∞–¥–∫–∞ "–ö–ª—é—á–∏" —Å QR-–∫–æ–¥–æ–º** (20.02.2026, 06:00)
- [x] **–ö–Ω–æ–ø–∫–∞ "–°–∫–∞—á–∞—Ç—å –∫–æ–Ω—Ñ–∏–≥ (.conf)"** (20.02.2026, 06:30)
- [x] **–ö–Ω–æ–ø–∫–∞ "–ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å –∫–æ–Ω—Ñ–∏–≥"** (20.02.2026, 06:45)
- [x] **–ö–Ω–æ–ø–∫–∞ "–ü–æ–¥–∫–ª—é—á–∏—Ç—å"/"–û—Ç–∫–ª—é—á–∏—Ç—å"** (20.02.2026, 07:00)

### WireGuard (20.02.2026)
- [x] –°–µ—Ä–≤–µ—Ä —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –Ω–∞ –ø–æ—Ä—Ç—É 51820 (19.02.2026, 11:15)
- [x] –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è `/etc/wireguard/wg0.conf` —Å–æ–∑–¥–∞–Ω–∞ (19.02.2026, 11:20)
- [x] –°–µ—Ä–≤–∏—Å —Ä–∞–±–æ—Ç–∞–µ—Ç (`sudo systemctl status wg-quick@wg0`) (19.02.2026, 11:25)
- [x] –ö–ª—é—á–∏ —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω—ã –≤ `/etc/wireguard/` (19.02.2026, 11:30)
- [x] **–ü—É–±–ª–∏—á–Ω—ã–π –∫–ª—é—á:** `0gKla07MC1eDcaIuN4YSA5zKpDchNH0PCfELHBM3d34=`
- [x] **IP —Å–µ—Ä–≤–µ—Ä–∞:** `23.134.216.190:51820`

### üî• –ö—Ä–∏—Ç–∏—á–Ω—ã–µ –∑–∞–¥–∞—á–∏ –ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞ (19.02.2026)
- [x] **–ó–∞–º–µ–Ω–∏—Ç—å —Ç–µ—Å—Ç–æ–≤—ã–µ –∫–ª—é—á–∏ YooKassa** –Ω–∞ –ø—Ä–æ–¥–∞–∫—à–µ–Ω (19.02.2026, 17:00)
  - SHOP_ID: `1266298`
  - SECRET_KEY: `live_qGfOvzEBZkeKq-uhGWODlMjBC4mTavEpmZaYfwFX8Fo`
  - TEST_MODE: `false`
- [x] **–û—Ç–∫–ª—é—á–∏—Ç—å debug mode** –≤ Flask (`debug=False`) (19.02.2026, 17:30)
- [x] **–ù–∞—Å—Ç—Ä–æ–∏—Ç—å –∞–≤—Ç–æ–∑–∞–ø—É—Å–∫ Docker –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤** —á–µ—Ä–µ–∑ systemd (20.02.2026, 10:40)

### WireGuard API (20.02.2026, 07:00)
- [x] **–°–æ–∑–¥–∞–Ω endpoint** `/api/wireguard/config/{user_id}` ‚Äî —Å–∫–∞—á–∏–≤–∞–Ω–∏–µ .conf —Ñ–∞–π–ª–∞
- [x] **–°–æ–∑–¥–∞–Ω endpoint** `/api/wireguard/qr/{user_id}` ‚Äî –ø–æ–ª—É—á–µ–Ω–∏–µ QR-–∫–æ–¥–∞ (base64)
- [x] **–°–æ–∑–¥–∞–Ω endpoint** `/api/wireguard/status/{user_id}` ‚Äî –ø—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è
- [x] **–ù–æ–≤–∞—è –º–æ–¥–µ–ª—å** `VPNConfigModel` –¥–ª—è PostgreSQL
- [x] **–ü—Ä–æ–≤–µ—Ä–∫–∞ –∞–∫—Ç–∏–≤–Ω–æ–π –ø–æ–¥–ø–∏—Å–∫–∏** –ø–µ—Ä–µ–¥ –≤—ã–¥–∞—á–µ–π –∫–æ–Ω—Ñ–∏–≥–∞
- [x] **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –≥–µ–Ω–µ—Ä–∞—Ü–∏—è** –∫–æ–Ω—Ñ–∏–≥–∞ –ø—Ä–∏ –ø–µ—Ä–≤–æ–º –∑–∞–ø—Ä–æ—Å–µ
- [x] **–ì–µ–Ω–µ—Ä–∞—Ü–∏—è QR-–∫–æ–¥–æ–≤** —á–µ—Ä–µ–∑ QRCode.js (CDN)
- [x] **–ö–Ω–æ–ø–∫–∞ "–ü–æ–¥–∫–ª—é—á–∏—Ç—å"/"–û—Ç–∫–ª—é—á–∏—Ç—å"** –≤ –º–∏–Ω–∏-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏
- [x] **–ö–Ω–æ–ø–∫–∞ "–ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å –∫–æ–Ω—Ñ–∏–≥"** –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞

### üîß –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è .env (20.02.2026)
- [x] **–í—Å–µ —Å–µ–∫—Ä–µ—Ç—ã –≤—ã–Ω–µ—Å–µ–Ω—ã –≤ `.env`** (–∫–æ—Ä–µ–Ω—å –ø—Ä–æ–µ–∫—Ç–∞)
- [x] **docker-compose.yml** –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –∏–∑ `.env`
- [x] **`.env.example`** —Å–æ–∑–¥–∞–Ω –¥–ª—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏
- [x] **WireGuard –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ** –¥–æ–±–∞–≤–ª–µ–Ω—ã –≤ `.env`

### üë§ –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∏ –∞–≤—Ç–æ–∑–∞–ø—É—Å–∫ (20.02.2026)
- [x] –°–æ–∑–¥–∞–Ω —Å–∏—Å—Ç–µ–º–Ω—ã–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å `vpvks` (–±–µ–∑ –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–æ–≥–æ –≤—Ö–æ–¥–∞)
- [x] –ö–∞—Ç–∞–ª–æ–≥ `/opt/vpvks` –ø–µ—Ä–µ–¥–∞–Ω –≤–æ –≤–ª–∞–¥–µ–Ω–∏–µ `vpvks:vpvks`
- [x] –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –¥–æ–±–∞–≤–ª–µ–Ω –≤ –≥—Ä—É–ø–ø—É `docker` (–¥–ª—è –∑–∞–ø—É—Å–∫–∞ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤)
- [x] –°–æ–∑–¥–∞–Ω systemd-—Å–µ—Ä–≤–∏—Å `/etc/systemd/system/docker-vpvks.service` –¥–ª—è –∞–≤—Ç–æ–∑–∞–ø—É—Å–∫–∞ `docker compose up -d`
- [x] –°–µ—Ä–≤–∏—Å —É—Å–ø–µ—à–Ω–æ —Å—Ç–∞—Ä—Ç—É–µ—Ç –ø–æ—Å–ª–µ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∏

### üêò –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ PgBouncer (20.02.2026, 16:43)
- [x] **–û–±–Ω–∞—Ä—É–∂–µ–Ω–∞ –ø—Ä–æ–±–ª–µ–º–∞**: PgBouncer –ø—ã—Ç–∞–ª—Å—è –ø–æ–¥–∫–ª—é—á–∏—Ç—å—Å—è –∫ —Å–∞–º–æ–º—É —Å–µ–±–µ (host=pgbouncer)
- [x] **–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ**: –≤ `.env` –∏–∑–º–µ–Ω—ë–Ω `DATABASE_URL` —Å `@pgbouncer` –Ω–∞ `@postgres`
- [x] **–†–µ–∑—É–ª—å—Ç–∞—Ç**: backend —É—Å–ø–µ—à–Ω–æ —Å–æ–∑–¥–∞–ª —Ç–∞–±–ª–∏—Ü—ã –≤ –ë–î, –æ—à–∏–±–∫–∏ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∏—Å—á–µ–∑–ª–∏
- [x] **–ü—Ä–æ–≤–µ—Ä–∫–∞**: –ª–æ–≥–∏ PgBouncer –ø–æ–∫–∞–∑—ã–≤–∞—é—Ç —Ç–æ–ª—å–∫–æ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É, –±–µ–∑ –æ—à–∏–±–æ–∫

## –¢–µ–∫—É—â–∏–π —Å—Ç–∞—Ç—É—Å –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö

```bash
# Docker –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã –æ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è vpvks
sudo -u vpvks docker compose ps

# PostgreSQL –≤–µ—Ä—Å–∏—è
PostgreSQL 17-alpine (Docker)

# –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ —á–µ—Ä–µ–∑ PgBouncer (–∏—Å–ø—Ä–∞–≤–ª–µ–Ω–æ!)
DATABASE_URL=postgresql://vpn_bot_user:vp62RofV5h@postgres:5432/vpn_bot_db
# –í–Ω–∏–º–∞–Ω–∏–µ: —Ä–∞–Ω–µ–µ –±—ã–ª–æ @pgbouncer, —á—Ç–æ –≤—ã–∑—ã–≤–∞–ª–æ —Ü–∏–∫–ª–∏—á–µ—Å–∫—É—é –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—å.
```

## –û–±—Å–ª—É–∂–∏–≤–∞–Ω–∏–µ –∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ

### üîÑ –†–∞–±–æ—Ç–∞ —Å Git (–æ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è vpvks)

–í—Å–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ —Å —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–µ–º –≤—ã–ø–æ–ª–Ω—è—é—Ç—Å—è **–æ—Ç –∏–º–µ–Ω–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è `vpvks`**, —á—Ç–æ–±—ã –Ω–µ –Ω–∞—Ä—É—à–∞—Ç—å –ø—Ä–∞–≤–∞ –Ω–∞ —Ñ–∞–π–ª—ã.

```bash
# –ü–µ—Ä–µ–π—Ç–∏ –≤ –∫–∞—Ç–∞–ª–æ–≥ –ø—Ä–æ–µ–∫—Ç–∞
cd /opt/vpvks

# –û–±–Ω–æ–≤–∏—Ç—å –∫–æ–¥ –∏–∑ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è
sudo -u vpvks git pull

# –ï—Å–ª–∏ –Ω—É–∂–Ω–æ –∑–∞–∫–æ–º–º–∏—Ç–∏—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è (–Ω–∞–ø—Ä–∏–º–µ—Ä, –æ–±–Ω–æ–≤–∏—Ç—å .env.example)
sudo -u vpvks git add .
sudo -u vpvks git commit -m "–û–ø–∏—Å–∞–Ω–∏–µ –∏–∑–º–µ–Ω–µ–Ω–∏–π"
sudo -u vpvks git push
```

**–í–∞–∂–Ω–æ:** –î–ª—è push –ø–æ—Ç—Ä–µ–±—É–µ—Ç—Å—è –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è. GitHub –±–æ–ª—å—à–µ –Ω–µ –ø—Ä–∏–Ω–∏–º–∞–µ—Ç –ø–∞—Ä–æ–ª–∏, –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ **Personal Access Token** (–∫–ª–∞—Å—Å–∏—á–µ—Å–∫–∏–π —Å –ø—Ä–∞–≤–∞–º–∏ `repo` –∏–ª–∏ fine-grained —Å –¥–æ—Å—Ç—É–ø–æ–º –∫ —Å–æ–¥–µ—Ä–∂–∏–º–æ–º—É) –ª–∏–±–æ –Ω–∞—Å—Ç—Ä–æ–π—Ç–µ SSH.

**–ù–∞—Å—Ç—Ä–æ–π–∫–∞ Git –≤ –ø–µ—Ä–≤—ã–π —Ä–∞–∑:**
```bash
sudo -u vpvks git config --global user.name "Your Name"
sudo -u vpvks git config --global user.email "your@email.com"
```

### üîê Personal Access Token (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)

1. –°–æ–∑–¥–∞–π—Ç–µ —Ç–æ–∫–µ–Ω –Ω–∞ GitHub (Settings ‚Üí Developer settings ‚Üí Personal access tokens ‚Üí Tokens (classic) ‚Üí Generate new token)
2. –í—ã–±–µ—Ä–∏—Ç–µ scope **`repo`** (–¥–ª—è –¥–æ—Å—Ç—É–ø–∞ –∫ –ø—Ä–∏–≤–∞—Ç–Ω—ã–º —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è–º) –∏–ª–∏ —Ç–æ–ª—å–∫–æ –∫ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–º—É —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—é –ø—Ä–∏ fine-grained —Ç–æ–∫–µ–Ω–µ.
3. –ü—Ä–∏ push –≤–≤–µ–¥–∏—Ç–µ username –∏ –≤—Å—Ç–∞–≤—å—Ç–µ —Ç–æ–∫–µ–Ω –≤–º–µ—Å—Ç–æ –ø–∞—Ä–æ–ª—è.

–ß—Ç–æ–±—ã –Ω–µ –≤–≤–æ–¥–∏—Ç—å —Ç–æ–∫–µ–Ω –∫–∞–∂–¥—ã–π —Ä–∞–∑, –Ω–∞—Å—Ç—Ä–æ–π—Ç–µ –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ:
```bash
sudo -u vpvks git config --global credential.helper store
```
(–•—Ä–∞–Ω–∏—Ç —Ç–æ–∫–µ–Ω –≤ –æ—Ç–∫—Ä—ã—Ç–æ–º –≤–∏–¥–µ –≤ `~/.git-credentials` ‚Äì –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Ç–æ–ª—å–∫–æ –Ω–∞ –∑–∞—â–∏—â—ë–Ω–Ω–æ–º —Å–µ—Ä–≤–µ—Ä–µ.)

### üîÅ –ê–≤—Ç–æ–∑–∞–ø—É—Å–∫ —á–µ—Ä–µ–∑ systemd

–°–µ—Ä–≤–∏—Å `docker-vpvks` —É–ø—Ä–∞–≤–ª—è–µ—Ç –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞–º–∏:

```bash
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å—Ç–∞—Ç—É—Å
sudo systemctl status docker-vpvks

# –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã (–ø–æ—Å–ª–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –∫–æ–¥–∞)
sudo systemctl restart docker-vpvks

# –û—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –≤—Å–µ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã
sudo systemctl stop docker-vpvks

# –ó–∞–ø—É—Å—Ç–∏—Ç—å –≤—Ä—É—á–Ω—É—é
sudo systemctl start docker-vpvks

# –ü–æ—Å–º–æ—Ç—Ä–µ—Ç—å –ª–æ–≥–∏ —Å–µ—Ä–≤–∏—Å–∞
sudo journalctl -u docker-vpvks -f
```

–°–æ–¥–µ—Ä–∂–∏–º–æ–µ `/etc/systemd/system/docker-vpvks.service`:
```ini
[Unit]
Description=Docker Compose for vpvks app
Requires=docker.service
After=docker.service

[Service]
Type=oneshot
RemainAfterExit=yes
User=vpvks
Group=docker
WorkingDirectory=/opt/vpvks
ExecStart=/usr/bin/docker compose up -d
ExecStop=/usr/bin/docker compose down
StandardOutput=journal

[Install]
WantedBy=multi-user.target
```

## –ö–æ–º–∞–Ω–¥—ã –¥–ª—è –∑–∞–ø—É—Å–∫–∞ –∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è

### –ù–∞ —Å–µ—Ä–≤–µ—Ä–µ (Docker –æ—Ç vpvks)

```bash
# –ü–µ—Ä–µ–π—Ç–∏ –≤ –ø—Ä–æ–µ–∫—Ç
cd /opt/vpvks

# –ó–∞–ø—É—Å—Ç–∏—Ç—å –≤—Å–µ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã (–µ—Å–ª–∏ –Ω–µ –∑–∞–ø—É—â–µ–Ω—ã –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏)
sudo -u vpvks docker compose up -d

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å—Ç–∞—Ç—É—Å
sudo -u vpvks docker compose ps

# –ü–æ—Å–º–æ—Ç—Ä–µ—Ç—å –ª–æ–≥–∏
sudo -u vpvks docker compose logs -f backend
sudo -u vpvks docker compose logs -f bot

# –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä
sudo -u vpvks docker compose restart backend

# –û—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –≤—Å–µ
sudo -u vpvks docker compose down
```

### –õ–æ–∫–∞–ª—å–Ω–æ (–¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è)

```bash
# TUNA —Ç—É–Ω–Ω–µ–ª—å
tuna http 8080

# Backend
cd backend
PORT=8080 python3 server.py

# Bot
cd bot
python3 main.py
```

## –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

### üîê –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è (.env)

**–í—Å–µ —Å–µ–∫—Ä–µ—Ç—ã –≤—ã–Ω–µ—Å–µ–Ω—ã –≤ —Ñ–∞–π–ª `.env` –≤ –∫–æ—Ä–Ω–µ –ø—Ä–æ–µ–∫—Ç–∞!**

```bash
# –°–∫–æ–ø–∏—Ä—É–π .env.example –≤ .env –∏ –∑–∞–ø–æ–ª–Ω–∏ —Å–≤–æ–∏–º–∏ –∑–Ω–∞—á–µ–Ω–∏—è–º–∏
sudo -u vpvks cp .env.example .env
sudo -u vpvks nano .env   # –∏–ª–∏ vim
```

### bot/.env (–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∏–∑ .env)
```
TELEGRAM_BOT_TOKEN=8321727057:AAGJJwoVRoG7wYZQPfN9-q-IM4mHA82g2cU
BACKEND_URL=https://vpvks.ru
ADMIN_USER_IDS=699469085
DATABASE_URL=postgresql://vpn_bot_user:vp62RofV5h@postgres:5432/vpn_bot_db
MINI_APP_URL=https://vpvks.ru/miniapp
```

### backend/.env (–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∏–∑ .env)
```
SECRET_KEY=5n_IX5ODiFJcuR0ZDH5s1cCRRAQYZcOiHYn4ZQ5xjEc
PORT=8080
DATABASE_URL=postgresql://vpn_bot_user:vp62RofV5h@postgres:5432/vpn_bot_db

# YooKassa (PRODUCTION)
YOOKASSA_SHOP_ID=1266298
YOOKASSA_SECRET_KEY=live_qGfOvzEBZkeKq-uhGWODlMjBC4mTavEpmZaYfwFX8Fo
YOOKASSA_TEST_MODE=false
YOOKASSA_RETURN_URL=https://vpvks.ru/payment-success

# WireGuard
WG_SERVER_IP=10.0.0.1
WG_PORT=51820
WG_DNS=8.8.8.8
WG_SERVER_PUBLIC_KEY=0gKla07MC1eDcaIuN4YSA5zKpDchNH0PCfELHBM3d34=
WG_CONFIG_DIR=./wg_configs
```

### docker-compose.yml (–∏—Å–ø–æ–ª—å–∑—É–µ—Ç .env)
```yaml
version: '3.8'

services:
  postgres:
    image: postgres:17-alpine
    container_name: vpn_postgres
    env_file:
      - .env
    environment:
      POSTGRES_DB: ${POSTGRES_DB}
      POSTGRES_USER: ${POSTGRES_USER}
      POSTGRES_PASSWORD: ${POSTGRES_PASSWORD}
    volumes:
      - postgres_data:/var/lib/postgresql/data
    networks:
      - vpn_network
    healthcheck:
      test: ["CMD-SHELL", "pg_isready -U ${POSTGRES_USER} -d ${POSTGRES_DB}"]
      interval: 10s
      timeout: 5s
      retries: 5

  pgbouncer:
    image: edoburu/pgbouncer:latest
    container_name: vpn_pgbouncer
    restart: always
    env_file:
      - .env
    environment:
      DATABASE_URL: ${DATABASE_URL}
      POOL_MODE: ${POOL_MODE}
      MAX_CLIENT_CONN: ${MAX_CLIENT_CONN}
      DEFAULT_POOL_SIZE: ${DEFAULT_POOL_SIZE}
      ADMIN_USERS: ${ADMIN_USERS}
      AUTH_TYPE: ${AUTH_TYPE}
      IGNORE_STARTUP_PARAMETERS: ${IGNORE_STARTUP_PARAMETERS}
    ports:
      - "6432:5432"
    depends_on:
      postgres:
        condition: service_healthy
    networks:
      - vpn_network

  backend:
    build: ./backend
    container_name: vpn_backend
    restart: always
    env_file:
      - .env
    environment:
      PORT: ${PORT}
      DATABASE_URL: ${DATABASE_URL}
      YOOKASSA_SHOP_ID: ${YOOKASSA_SHOP_ID}
      YOOKASSA_SECRET_KEY: ${YOOKASSA_SECRET_KEY}
      YOOKASSA_TEST_MODE: ${YOOKASSA_TEST_MODE}
      YOOKASSA_RETURN_URL: ${YOOKASSA_RETURN_URL}
      SECRET_KEY: ${SECRET_KEY}
      WG_SERVER_IP: ${WG_SERVER_IP}
      WG_PORT: ${WG_PORT}
      WG_DNS: ${WG_DNS}
      WG_SERVER_PUBLIC_KEY: ${WG_SERVER_PUBLIC_KEY}
      WG_CONFIG_DIR: ${WG_CONFIG_DIR}
    ports:
      - "8080:8080"
    depends_on:
      pgbouncer:
        condition: service_started
    networks:
      - vpn_network
    volumes:
      - ./backend:/app

  bot:
    build: ./bot
    container_name: vpn_bot
    restart: always
    env_file:
      - .env
    environment:
      TELEGRAM_BOT_TOKEN: ${TELEGRAM_BOT_TOKEN}
      BACKEND_URL: ${BACKEND_URL}
      ADMIN_USER_IDS: ${ADMIN_USER_IDS}
      DATABASE_URL: ${DATABASE_URL}
      MINI_APP_URL: ${MINI_APP_URL}
    depends_on:
      - backend
    networks:
      - vpn_network
    volumes:
      - ./bot:/app

networks:
  vpn_network:
    driver: bridge

volumes:
  postgres_data:
    driver: local
```

## WireGuard –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

### –°–µ—Ä–≤–µ—Ä
- –ö–æ–Ω—Ñ–∏–≥: `/etc/wireguard/wg0.conf`
- –ü–æ—Ä—Ç: `51820/udp`
- –ü–æ–¥—Å–µ—Ç—å: `10.0.0.1/24`
- –ü—É–±–ª–∏—á–Ω—ã–π –∫–ª—é—á: `0gKla07MC1eDcaIuN4YSA5zKpDchNH0PCfELHBM3d34=`
- IP —Å–µ—Ä–≤–µ—Ä–∞: `23.134.216.190:51820`
- –ö–ª—é—á–∏: `/etc/wireguard/server_private_key`, `/etc/wireguard/server_public_key`

### üîå API endpoints

| Endpoint | –ú–µ—Ç–æ–¥ | –û–ø–∏—Å–∞–Ω–∏–µ |
|----------|-------|----------|
| `/api/wireguard/config/<user_id>` | GET | –°–∫–∞—á–∞—Ç—å .conf —Ñ–∞–π–ª WireGuard |
| `/api/wireguard/qr/<user_id>` | GET | –ü–æ–ª—É—á–∏—Ç—å QR-–∫–æ–¥ —Å –∫–æ–Ω—Ñ–∏–≥–æ–º (base64 + —Ç–µ–∫—Å—Ç) |
| `/api/wireguard/status/<user_id>` | GET | –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å—Ç–∞—Ç—É—Å –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è |

### –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è API

```bash
# –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è
curl https://vpvks.ru/api/wireguard/status/699469085

# –°–∫–∞—á–∞—Ç—å –∫–æ–Ω—Ñ–∏–≥ —Ñ–∞–π–ª
curl -O https://vpvks.ru/api/wireguard/config/699469085

# –ü–æ–ª—É—á–∏—Ç—å QR-–∫–æ–¥ (JSON —Å base64 –∏ —Ç–µ–∫—Å—Ç–æ–º)
curl https://vpvks.ru/api/wireguard/qr/699469085
```

### –ü—Ä–∏–º–µ—Ä –æ—Ç–≤–µ—Ç–∞ API (QR endpoint)

```json
{
  "status": "success",
  "user_id": 699469085,
  "config_base64": "W0ludGVyZmFjZV0KUHJpdmF0ZUtleSA9IC4uLg==",
  "config_text": "[Interface]\nPrivateKey = ...\nAddress = 10.0.0.87/32\n..."
}
```

### üì± –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫–ª–∏–µ–Ω—Ç–∞

**1. –ß–µ—Ä–µ–∑ QR-–∫–æ–¥:**
- –û—Ç–∫—Ä–æ–π –º–∏–Ω–∏-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ (@relatevpnbot ‚Üí `/app` ‚Üí "–ö–ª—é—á–∏")
- –û—Ç—Å–∫–∞–Ω–∏—Ä—É–π QR-–∫–æ–¥ –≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏ WireGuard

**2. –ß–µ—Ä–µ–∑ —Ñ–∞–π–ª:**
- –ù–∞–∂–º–∏ "–°–∫–∞—á–∞—Ç—å –∫–æ–Ω—Ñ–∏–≥ (.conf)"
- –ò–º–ø–æ—Ä—Ç–∏—Ä—É–π —Ñ–∞–π–ª `wg_config_*.conf` –≤ WireGuard

**3. –ß–µ—Ä–µ–∑ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞:**
- –ù–∞–∂–º–∏ "–ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å –∫–æ–Ω—Ñ–∏–≥"
- –í WireGuard: "+" ‚Üí "–°–æ–∑–¥–∞—Ç—å –∏–∑ –±—É—Ñ–µ—Ä–∞ –æ–±–º–µ–Ω–∞"

### –ö–æ–Ω—Ñ–∏–≥ –∫–ª–∏–µ–Ω—Ç–∞ (–ø—Ä–∏–º–µ—Ä)

```ini
[Interface]
PrivateKey = <—Ç–≤–æ–π_–ø—Ä–∏–≤–∞—Ç–Ω—ã–π_–∫–ª—é—á>
Address = 10.0.0.87/32
DNS = 8.8.8.8

[Peer]
PublicKey = 0gKla07MC1eDcaIuN4YSA5zKpDchNH0PCfELHBM3d34=
Endpoint = 23.134.216.190:51820
AllowedIPs = 0.0.0.0/0
PersistentKeepalive = 25
```

### –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –∫–ª–∏–µ–Ω—Ç–∞ –≤—Ä—É—á–Ω—É—é

```bash
# –ù–∞ —Å–µ—Ä–≤–µ—Ä–µ
cd /etc/wireguard/
wg genkey | tee client_private_key | wg pubkey > client_public_key

# –î–æ–±–∞–≤—å –∫–ª–∏–µ–Ω—Ç–∞
sudo wg set wg0 peer <CLIENT_PUBLIC_KEY> allowed-ips 10.0.0.X/32
```

## –†–µ—à–µ–Ω–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã

### 20.02.2026 ‚Äî WireGuard –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è

1. **`wg` –∫–æ–º–∞–Ω–¥–∞ –Ω–µ –Ω–∞–π–¥–µ–Ω–∞ –≤ Docker –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–µ**
   - –†–µ—à–µ–Ω–∏–µ: –î–æ–±–∞–≤–ª–µ–Ω `wireguard-tools` –≤ `backend/Dockerfile`

2. **`WG_SERVER_PUBLIC_KEY` –Ω–µ –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è –≤ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä**
   - –†–µ—à–µ–Ω–∏–µ: –í—Å–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –≤—ã–Ω–µ—Å–µ–Ω—ã –≤ `.env`, docker-compose –∏—Å–ø–æ–ª—å–∑—É–µ—Ç `env_file`

3. **–û—à–∏–±–∫–∞ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –ø—É–±–ª–∏—á–Ω–æ–≥–æ –∫–ª—é—á–∞ (`'bytes' object has no attribute 'fileno'`)**
   - –†–µ—à–µ–Ω–∏–µ: –ò—Å–ø—Ä–∞–≤–ª–µ–Ω `_generate_client_public_key` —á–µ—Ä–µ–∑ `subprocess.Popen.communicate()`

4. **–ë–∏–±–ª–∏–æ—Ç–µ–∫–∞ QRCode –Ω–µ –∑–∞–≥—Ä—É–∂–µ–Ω–∞ –≤ –º–∏–Ω–∏-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏**
   - –†–µ—à–µ–Ω–∏–µ: –ó–∞–º–µ–Ω—ë–Ω CDN —Å jsdelivr –Ω–∞ cloudflare, –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è QRCode.js

5. **–§–∞–π–ª –∫–æ–Ω—Ñ–∏–≥–∞ —Å–∫–∞—á–∏–≤–∞–µ—Ç—Å—è –∫–∞–∫ `.txt` –≤–º–µ—Å—Ç–æ `.conf`**
   - –†–µ—à–µ–Ω–∏–µ: –ò–∑–º–µ–Ω—ë–Ω MIME —Ç–∏–ø –Ω–∞ `text/plain;charset=utf-8`, —è–≤–Ω–æ–µ –∏–º—è —Ñ–∞–π–ª–∞ `wg_config_*.conf`

6. **`tg.showNotification is not a function`**
   - –†–µ—à–µ–Ω–∏–µ: –î–æ–±–∞–≤–ª–µ–Ω fallback –Ω–∞ `alert()` –µ—Å–ª–∏ –º–µ—Ç–æ–¥ –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω

7. **–¢—Ä–∞—Ñ–∏–∫ —É—Ö–æ–¥–∏—Ç –Ω–æ –Ω–µ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç—Å—è (0 –±–∞–π—Ç –ø—Ä–∏–Ω—è—Ç–æ)**
   - –†–µ—à–µ–Ω–∏–µ: –î–æ–±–∞–≤–ª–µ–Ω—ã –æ–±–∞ IP –≤ `allowed ips`: `10.0.0.2/32, 10.0.0.87/32`
   - –ü—Ä–æ–≤–µ—Ä–µ–Ω–æ: NAT –ø—Ä–∞–≤–∏–ª–∞, IP forwarding, firewall

### –ü—Ä–∏ —Ä–∞–∑–≤—ë—Ä—Ç—ã–≤–∞–Ω–∏–∏ (19.02.2026)

1. **PM2 –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç —Å Python** ‚Äî —É–¥–∞–ª–∏–ª–∏ PM2, –∑–∞–ø—É—Å–∫–∞–µ–º Python –Ω–∞–ø—Ä—è–º—É—é
2. **–ù–µ–≤–µ—Ä–Ω—ã–π –ø–æ—Ä—Ç PgBouncer** ‚Äî –∏–∑–º–µ–Ω–∏–ª–∏ —Å 6432 –Ω–∞ 5432 –≤ DATABASE_URL
3. **–û—à–∏–±–∫–∞ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ PostgreSQL** ‚Äî –Ω–∞—Å—Ç—Ä–æ–∏–ª–∏ `AUTH_TYPE: scram-sha-256` –¥–ª—è PgBouncer
4. **Telegram —Ç—Ä–µ–±—É–µ—Ç HTTPS –¥–ª—è Mini App** ‚Äî –∏–∑–º–µ–Ω–∏–ª–∏ URL —Å `http://localhost:8080` –Ω–∞ `https://vpvks.ru`
5. **Docker –Ω–µ –≤–∏–¥–∏—Ç –∏–∑–º–µ–Ω–µ–Ω–∏—è** ‚Äî –≤—ã–ø–æ–ª–Ω—è–ª–∏ `git pull` + `docker compose up -d --build --force-recreate`

### 20.02.2026 ‚Äî –ü—Ä–∞–≤–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∏ –∞–≤—Ç–æ–∑–∞–ø—É—Å–∫

1. **–û—à–∏–±–∫–∞ `Operation not permitted` –ø—Ä–∏ `chown` –æ—Ç admin**
   - –†–µ—à–µ–Ω–∏–µ: –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `sudo` –¥–ª—è –∏–∑–º–µ–Ω–µ–Ω–∏—è –≤–ª–∞–¥–µ–ª—å—Ü–∞
2. **Git –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ –æ "dubious ownership"**
   - –†–µ—à–µ–Ω–∏–µ: –í—ã–ø–æ–ª–Ω—è—Ç—å `git` –æ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è `vpvks` (`sudo -u vpvks git ...`) –∏–ª–∏ –¥–æ–±–∞–≤–∏—Ç—å –∏—Å–∫–ª—é—á–µ–Ω–∏–µ `safe.directory`
3. **–û—à–∏–±–∫–∞ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ GitHub –ø—Ä–∏ push**
   - –†–µ—à–µ–Ω–∏–µ: –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å Personal Access Token –≤–º–µ—Å—Ç–æ –ø–∞—Ä–æ–ª—è

### 20.02.2026 ‚Äî –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ PgBouncer

4. **Backend –Ω–µ –º–æ–≥ –ø–æ–¥–∫–ª—é—á–∏—Ç—å—Å—è –∫ –ë–î (client_login_timeout)**
   - –ü—Ä–∏—á–∏–Ω–∞: –í `DATABASE_URL` –±—ã–ª —É–∫–∞–∑–∞–Ω —Ö–æ—Å—Ç `pgbouncer` –≤–º–µ—Å—Ç–æ `postgres`, —á—Ç–æ –≤—ã–∑—ã–≤–∞–ª–æ —Ü–∏–∫–ª–∏—á–µ—Å–∫—É—é –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—å
   - –†–µ—à–µ–Ω–∏–µ: –ò–∑–º–µ–Ω—ë–Ω `.env` —Å `@pgbouncer` –Ω–∞ `@postgres`
   - –†–µ–∑—É–ª—å—Ç–∞—Ç: backend —É—Å–ø–µ—à–Ω–æ —Å–æ–∑–¥–∞–ª —Ç–∞–±–ª–∏—Ü—ã, –æ—à–∏–±–∫–∏ –∏—Å—á–µ–∑–ª–∏

### –†–∞–Ω–µ–µ —Ä–µ—à–µ–Ω–Ω—ã–µ

5. **–ö–æ–Ω—Ñ–ª–∏–∫—Ç –±–æ—Ç–æ–≤** ‚Äî –∑–∞–ø—É—â–µ–Ω —Ç–æ–ª—å–∫–æ –æ–¥–∏–Ω —ç–∫–∑–µ–º–ø–ª—è—Ä
6. **–û–ø–ª–∞—Ç–∞ –Ω–∞ iOS** ‚Äî –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è tg.openLink()
7. **–î–∞—Ç–∞ –ø–æ–¥–ø–∏—Å–∫–∏ –Ω–µ –æ–±–Ω–æ–≤–ª—è–ª–∞—Å—å** ‚Äî –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∞ –ª–æ–≥–∏–∫–∞ –∞–∫—Ç–∏–≤–∞—Ü–∏–∏
8. **–û—Ç–∫—Ä—ã—Ç–∏–µ –Ω–µ—Å—É—â–µ—Å—Ç–≤—É—é—â–µ–π —Å—Ç—Ä–∞–Ω–∏—Ü—ã –ÆKassa** ‚Äî —Å–∏–º—É–ª—è—Ü–∏—è –≤ —Ç–µ—Å—Ç–æ–≤–æ–º —Ä–µ–∂–∏–º–µ
9. **TUNA —Ç—É–Ω–Ω–µ–ª—å –æ–±—Ä—ã–≤–∞–ª—Å—è** ‚Äî –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∞
10. **WireGuard –Ω–µ –∑–∞–ø—É—Å–∫–∞–ª—Å—è** ‚Äî –∏—Å–ø—Ä–∞–≤–ª–µ–Ω —Ñ–æ—Ä–º–∞—Ç –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ (–±–µ–∑ –ø–µ—Ä–µ–Ω–æ—Å–æ–≤ —Å—Ç—Ä–æ–∫)

## –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

### –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–±–æ—Ç—ã (20.02.2026, 17:30)

```bash
# –ü—Ä–æ–≤–µ—Ä–∫–∞ Docker –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤ –æ—Ç vpvks
sudo -u vpvks docker compose ps

# –û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:
# NAME            STATUS
# vpn_backend     Up
# vpn_bot         Up
# vpn_pgbouncer   Up
# vpn_postgres    Healthy

# –ü—Ä–æ–≤–µ—Ä–∫–∞ systemd —Å–µ—Ä–≤–∏—Å–∞
sudo systemctl status docker-vpvks

# –ü—Ä–æ–≤–µ—Ä–∫–∞ API
curl -I https://vpvks.ru/api/status

# –û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:
# HTTP/2 200
# server: nginx/1.24.0 (Ubuntu)

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –±–æ—Ç–∞
# –û—Ç–∫—Ä–æ–π @relatevpnbot –≤ Telegram ‚Üí /start

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –ª–æ–≥–æ–≤
sudo -u vpvks docker compose logs backend
sudo -u vpvks docker compose logs bot
```

### WireGuard

```bash
# –ü—Ä–æ–≤–µ—Ä–∫–∞ WireGuard
sudo wg show
sudo ss -tulpn | grep 51820
```

## –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏

### –ê–∫—Ç—É–∞–ª—å–Ω—ã–µ (20.02.2026, 17:30)

1. ‚úÖ **–ù–∞—Å—Ç—Ä–æ–∏—Ç—å SSL-—Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç—ã** ‚Äî –≤—ã–ø–æ–ª–Ω–µ–Ω–æ (Let's Encrypt) (19.02.2026, 09:45)
2. ‚úÖ **–†–∞–∑–≤–µ—Ä–Ω—É—Ç—å Docker –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã** ‚Äî –≤—ã–ø–æ–ª–Ω–µ–Ω–æ (19.02.2026, 10:00)
3. ‚úÖ **–ù–∞—Å—Ç—Ä–æ–∏—Ç—å PgBouncer** ‚Äî –≤—ã–ø–æ–ª–Ω–µ–Ω–æ (scram-sha-256) (19.02.2026, 11:00)
4. ‚úÖ **–ó–∞–º–µ–Ω–∏—Ç—å —Ç–µ—Å—Ç–æ–≤—ã–µ –∫–ª—é—á–∏ YooKassa** ‚Äî –≤—ã–ø–æ–ª–Ω–µ–Ω–æ (19.02.2026, 17:00)
5. ‚úÖ **–û—Ç–∫–ª—é—á–∏—Ç—å debug mode** ‚Äî –≤—ã–ø–æ–ª–Ω–µ–Ω–æ (19.02.2026, 17:30)
6. ‚úÖ **–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è WireGuard API** ‚Äî –≤—ã–ø–æ–ª–Ω–µ–Ω–æ (20.02.2026, 07:00)
7. ‚úÖ **QR-–∫–æ–¥—ã –¥–ª—è –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –≤ –º–∏–Ω–∏-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏** ‚Äî –≤—ã–ø–æ–ª–Ω–µ–Ω–æ (20.02.2026, 07:00)
8. ‚úÖ **–ö–Ω–æ–ø–∫–∏ "–ü–æ–¥–∫–ª—é—á–∏—Ç—å"/"–û—Ç–∫–ª—é—á–∏—Ç—å"** ‚Äî –≤—ã–ø–æ–ª–Ω–µ–Ω–æ (20.02.2026, 07:00)
9. ‚úÖ **–°–æ–∑–¥–∞–Ω–∏–µ –æ—Ç–¥–µ–ª—å–Ω–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è `vpvks` –∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ –ø—Ä–∞–≤** ‚Äî –≤—ã–ø–æ–ª–Ω–µ–Ω–æ (20.02.2026, 10:30)
10. ‚úÖ **–ê–≤—Ç–æ–∑–∞–ø—É—Å–∫ —á–µ—Ä–µ–∑ systemd** ‚Äî –≤—ã–ø–æ–ª–Ω–µ–Ω–æ (20.02.2026, 10:40)
11. ‚úÖ **–ù–∞—Å—Ç—Ä–æ–π–∫–∞ Git –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è vpvks** ‚Äî –≤—ã–ø–æ–ª–Ω–µ–Ω–æ (20.02.2026, 12:00)
12. ‚úÖ **–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ PgBouncer (DATABASE_URL)** ‚Äî –≤—ã–ø–æ–ª–Ω–µ–Ω–æ (20.02.2026, 16:43)
13. ‚è≥ **–î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è** ‚Äî —Ç—Ä–∞—Ñ–∏–∫ —É—Ö–æ–¥–∏—Ç –Ω–æ –Ω–µ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç—Å—è (–ü–†–ò–û–†–ò–¢–ï–¢!)
14. ‚è≥ **–ê–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è —Å–æ–∑–¥–∞–Ω–∏—è –∫–ª–∏–µ–Ω—Ç–æ–≤** –ø—Ä–∏ –ø–æ–∫—É–ø–∫–µ ‚Äî –≤ –ø–ª–∞–Ω–∞—Ö

### –î–æ–ª–≥–æ—Å—Ä–æ—á–Ω—ã–µ

- –ù–∞—Å—Ç—Ä–æ–∏—Ç—å –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∏ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ (Prometheus + Grafana)
- –ù–∞—Å—Ç—Ä–æ–∏—Ç—å —Ä–µ–∑–µ—Ä–≤–Ω–æ–µ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ –ë–î (–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ –¥–∞–º–ø—ã)
- –ü—Ä–æ–≤–µ—Å—Ç–∏ –Ω–∞–≥—Ä—É–∑–æ—á–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ
- –î–æ–±–∞–≤–∏—Ç—å –ø–æ–¥–¥–µ—Ä–∂–∫—É v2ray/Xray –¥–ª—è –æ–±—Ö–æ–¥–∞ –±–ª–æ–∫–∏—Ä–æ–≤–æ–∫

## –ö–æ–Ω—Ç–∞–∫—Ç—ã

- –°–µ—Ä–≤–µ—Ä: 23.134.216.190
- –ë–æ—Ç: @relatevpnbot
- Admin ID: 699469085
- –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –¥–ª—è –∑–∞–ø—É—Å–∫–∞: `vpvks` (–Ω–µ –¥–ª—è –≤—Ö–æ–¥–∞)
